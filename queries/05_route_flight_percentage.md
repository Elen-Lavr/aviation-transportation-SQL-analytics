### :exclamation: Задача 5
```txt
Найдите процентное соотношение перелетов по маршрутам от общего количества перелетов. 
Выведите в результат названия аэропортов и процентное отношение.
Решение должно быть через оконную функцию.
```
### :paperclip: SQL-запрос
```sql
select distinct a.airport_name, b.airport_name,
count (f.flight_id) over (partition by departure_airport, arrival_airport)*100/ count(f.flight_id) over ()::numeric as "Процентное_соотношение_перелетов"
from flights f 
join airports a on a. airport_code = f.departure_airport 
join airports b on b. airport_code = f.arrival_airport;
```
### :heavy_check_mark: Результат выполнения
```csv
airport_name        |airport_name        |Процентное_соотношение_перелетов|
--------------------+--------------------+--------------------------------+
Спиченково          |Емельяново          |          0.36834636635367289635|
Пулково             |Якутск              |          0.18417318317683644817|
Пулково             |Чульман             |          0.02717309259986111530|
Элиста              |Оренбург-Центральный|          0.18417318317683644817|
Шереметьево         |Бугульма            |          0.18417318317683644817|
Ставрополь          |Челябинск           |          0.08151927779958334591|
Белгород            |Сочи                |          0.36834636635367289635|
Нальчик             |Стригино            |          0.18417318317683644817|
Кольцово            |Магнитогорск        |          0.18417318317683644817|
Шереметьево         |Мирный              |          0.18417318317683644817|
Домодедово          |Курган              |          0.08151927779958334591|
Краснодар           |Баратаевка          |          0.18417318317683644817|
Советский           |Домодедово          |          0.36834636635367289635|
Сургут              |Иркутск             |          0.18417318317683644817|
Белгород            |Витязево            |          0.18417318317683644817|
Победилово          |Домодедово          |          0.18417318317683644817|
Байкал              |Внуково             |          0.07850004528848766644|
Нефтеюганск         |Шереметьево         |          0.07850004528848766644|
Туношна             |Пулково             |          0.18417318317683644817|
Ростов-на-Дону      |Богашёво            |          0.02415386008876543583|
Емельяново          |Барнаул             |          0.18417318317683644817|
Абакан              |Грозный             |          0.02717309259986111530|
Горно-Алтайск       |Ставрополь          |          0.02717309259986111530|
Геленджик           |Внуково             |          0.07850004528848766644|
Надым               |Иркутск             |          0.05132695268862655113|
Рощино              |Пулково             |          0.18417318317683644817|
Домодедово          |Баратаевка          |          0.18417318317683644817|
Магадан             |Иркутск             |          0.05434618519972223061|
Абакан              |Талаги              |          0.02415386008876543583|
Домодедово          |Кемерово            |          0.08151927779958334591|
Шереметьево         |Стригино            |          0.36834636635367289635|
Шереметьево         |Усинск              |          0.02717309259986111530|
Курган              |Белоярский          |          0.05434618519972223061|...
```
