### :exclamation: Задача 4
Вывести накопительный итог количества мест в самолетах по каждому аэропорту на каждый день, учитывая только те самолеты, которые летали пустыми и только те дни, где из одного аэропорта таких самолетов вылетало более одного.

В результате должны быть: 
 - код аэропорта,
 - дата,
 - количество пустых мест в самолете и накопительный итог.

### :paperclip: SQL-запрос
```sql
with cte1 as (
	select actual_departure, departure_airport, aircraft_code,
	count (aircraft_code) over (partition by actual_departure::date, departure_airport) as number_of_flights
	from flights f 
	left join boarding_passes bp on bp.flight_id = f.flight_id 
	where bp.ticket_no is null and actual_departure is not null
	order by actual_departure
	),
cte2 as (
	select aircraft_code, count(seat_no) as seating_positions
	from seats s 
	group by aircraft_code
	)	
select departure_airport,  actual_departure, seating_positions,
	sum (cte2.seating_positions) over (partition by cte1.departure_airport,  actual_departure::date order by actual_departure)
from cte1
join cte2 on cte2. aircraft_code = cte1. aircraft_code
where number_of_flights >1
order by actual_departure::date, departure_airport;
```
### :heavy_check_mark: Результат выполнения
```csv
aircraft_name
Cessna 172
ATR 42
Bombardier CRJ200
```
